# Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ¤λ¥ ν•΄κ²° λ° μ¬λ°°ν¬

## π“… μ‘μ—… μΌμ: 2025-08-27
## π• μ‘μ—… μ‹κ°„: 13:18 - 13:25 UTC (μ•½ 7λ¶„)
## π‘¤ μ‘μ—…μ: hcsung (Amazon Q μ§€μ›)
## π λ¦¬μ „: ap-northeast-1 (λ„μΏ„)

---

## π― λ¬Έμ  μƒν™©
- **μ¤λ¥ λ©”μ‹μ§€**: `amazon.nova-micro-v1:0 μ¤νΈλ¦¬λ° μ¤λ¥: 'NoneType' object has no attribute 'invoke_model_with_response_stream'`
- **μ¦μƒ**: μ±—λ΄‡μ—μ„ μ§λ¬Έ μ…λ ¥ μ‹ Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨λ΅ μΈν• μ¤νΈλ¦¬λ° μ¤λ¥ λ°μƒ
- **μν–¥**: μ‚¬μ©μκ°€ μ±—λ΄‡ κΈ°λ¥μ„ μ „ν€ μ‚¬μ©ν•  μ μ—†λ” μƒνƒ

---

## π” λ¬Έμ  μ§„λ‹¨ κ³Όμ •

### 1λ‹¨κ³„: μ¤λ¥ λ¶„μ„
- **κ·Όλ³Έ μ›μΈ**: `StreamingHandler` ν΄λμ¤μ—μ„ Bedrock ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ§€ λ»ν•¨
- **μ„Έλ¶€ μ›μΈ**: 
  1. AWS ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” κ³Όμ •μ—μ„ `None` κ°’ μ „λ‹¬ κ°€λ¥μ„±
  2. ν΄λΌμ΄μ–ΈνΈ ν‚¤ μ΄λ¦„ λ¶μΌμΉ (`bedrock-runtime` vs `bedrock`)
  3. ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨ μ‹ μμ™Έ μ²λ¦¬ λ¶€μ΅±

### 2λ‹¨κ³„: μ½”λ“ λ¶„μ„
- **λ¬Έμ  νμΌ**: `/src/core/streaming_handler.py`
- **λ¬Έμ  μ½”λ“**: 
  ```python
  if 'bedrock' not in aws_clients and 'bedrock-runtime' not in aws_clients:
      raise ValueError("AWS Bedrock ν΄λΌμ΄μ–ΈνΈκ°€ ν•„μ”ν•©λ‹λ‹¤")
  
  self.bedrock_client = aws_clients.get('bedrock') or aws_clients.get('bedrock-runtime')
  ```
- **λ¬Έμ μ **: ν΄λΌμ΄μ–ΈνΈκ°€ `None`μΈ κ²½μ°μ— λ€ν• μ²λ¦¬ λ¶€μ΅±

---

## π› οΈ ν•΄κ²° λ°©λ²•

### 1λ‹¨κ³„: StreamingHandler μμ •
**νμΌ**: `/src/core/streaming_handler.py`

**μμ • λ‚΄μ©**:
```python
def __init__(self, aws_clients: Dict[str, Any], logger=None):
    """StreamingHandler μ΄κΈ°ν™”"""
    self.aws_clients = aws_clients
    self.logger = logger
    
    # Bedrock ν΄λΌμ΄μ–ΈνΈ ν™•μΈ λ° μ΄κΈ°ν™”
    self.bedrock_client = None
    
    # λ‹¤μ–‘ν• ν‚¤ μ΄λ¦„μΌλ΅ Bedrock ν΄λΌμ΄μ–ΈνΈ μ°ΎκΈ°
    possible_keys = ['bedrock-runtime', 'bedrock', 'bedrock_runtime']
    for key in possible_keys:
        if key in aws_clients and aws_clients[key] is not None:
            self.bedrock_client = aws_clients[key]
            print(f"β… Bedrock ν΄λΌμ΄μ–ΈνΈ μ°Ύμ: {key}")
            break
    
    # ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ§€ λ»ν• κ²½μ° μ§μ ‘ μƒμ„± μ‹λ„
    if self.bedrock_client is None:
        print("β οΈ Bedrock ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ§€ λ»ν•¨. μ§μ ‘ μƒμ„± μ‹λ„...")
        try:
            import boto3
            from botocore.config import Config
            
            config = Config(
                read_timeout=60,
                connect_timeout=10,
                retries={'max_attempts': 3, 'mode': 'adaptive'}
            )
            
            self.bedrock_client = boto3.client(
                'bedrock-runtime',
                region_name='us-east-1',
                config=config
            )
            print("β… Bedrock ν΄λΌμ΄μ–ΈνΈ μ§μ ‘ μƒμ„± μ„±κ³µ")
            
        except Exception as e:
            print(f"β Bedrock ν΄λΌμ΄μ–ΈνΈ μƒμ„± μ‹¤ν¨: {e}")
            raise ValueError(f"AWS Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨: {e}")
    
    # ν΄λΌμ΄μ–ΈνΈ μ ν¨μ„± κ²€μ‚¬
    if self.bedrock_client is None:
        raise ValueError("AWS Bedrock ν΄λΌμ΄μ–ΈνΈκ°€ Noneμ…λ‹λ‹¤")
```

### 2λ‹¨κ³„: AWS ν΄λΌμ΄μ–ΈνΈ κ΄€λ¦¬μ κ°μ„ 
**νμΌ**: `/src/core/aws_clients.py`

**μμ • λ‚΄μ©**:
- μ‹¤ν¨ν• ν΄λΌμ΄μ–ΈνΈλ¥Ό `None`μΌλ΅ μ„¤μ •ν•μ§€ μ•κ³  μ μ™Έ
- μ¤‘μ”ν• μ„λΉ„μ¤(`bedrock-runtime`) μ‹¤ν¨ μ‹ μ¬μ‹λ„ λ΅μ§ μ¶”κ°€
- λ” μƒμ„Έν• λ΅κΉ… λ° μ¤λ¥ μ²λ¦¬

### 3λ‹¨κ³„: λ©”μΈ μ• ν”λ¦¬μΌ€μ΄μ… μ•μ „μ„± κ°•ν™”
**νμΌ**: `/src/chatbot_app.py`

**μμ • λ‚΄μ©**:
- ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨ μ‹ Streamlit μ•± μ¤‘λ‹¨
- StreamingHandler μ΄κΈ°ν™” μ‹¤ν¨ μ‹ λ””λ²„κΉ… μ •λ³΄ ν‘μ‹
- λ” λ…ν™•ν• μ¤λ¥ λ©”μ‹μ§€ μ κ³µ

---

## π€ λ°°ν¬ κ³Όμ •

### 1λ‹¨κ³„: μ½”λ“ μ—…λ΅λ“
```bash
aws s3 sync /home/hcsung/global-dual-nova-rag-chatbot/src/ s3://dual-nova-chatbot-production-code-62eea701/src/ --region ap-northeast-1 --delete
```

**κ²°κ³Ό**: 
- `src/core/aws_clients.py` μ—…λ΅λ“ μ™„λ£
- `src/chatbot_app.py` μ—…λ΅λ“ μ™„λ£  
- `src/core/streaming_handler.py` μ—…λ΅λ“ μ™„λ£

### 2λ‹¨κ³„: ECS μ„λΉ„μ¤ μ—…λ°μ΄νΈ
```bash
aws ecs update-service --cluster dual-nova-chatbot-production-cluster --service dual-nova-chatbot-production-service --region ap-northeast-1
```

**κ²°κ³Ό**: μƒλ΅μ΄ λ°°ν¬ μ‹μ‘ (deployment ID: ecs-svc/4744708973545458407)

### 3λ‹¨κ³„: λ°°ν¬ λ¨λ‹ν„°λ§
- **μƒ νƒμ¤ν¬ ID**: `d26dc519320542838fad7bfb32c2a1c7`
- **μ‹μ‘ μ‹κ°„**: 2025-08-27 22:21:34 (ν•κµ­μ‹κ°„)
- **ν¨ν‚¤μ§€ μ„¤μΉ**: μ •μƒ μ™„λ£
- **μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘**: μ •μƒ μ™„λ£

---

## β… ν•΄κ²° κ²°κ³Ό

### μ• ν”λ¦¬μΌ€μ΄μ… μƒνƒ
- β… **HTTP μƒνƒ**: 200 OK
- β… **μ„λ²„**: TornadoServer/6.5.2 (Streamlit)
- β… **URL**: http://dual-nova-chatbot-production-alb-2134834621.ap-northeast-1.elb.amazonaws.com
- β… **ECS μ„λΉ„μ¤**: ACTIVE, runningCount=1, desiredCount=1

### κΈ°λ¥ ν…μ¤νΈ
- β… **μ›Ή μΈν„°νμ΄μ¤**: μ •μƒ λ΅λ“
- β… **Streamlit μ•±**: μ •μƒ μ‹¤ν–‰
- β… **Bedrock ν΄λΌμ΄μ–ΈνΈ**: μ΄κΈ°ν™” μ„±κ³µ (μ¤λ¥ λ©”μ‹μ§€ μ—†μ)

### λ΅κ·Έ λ¶„μ„
```
Starting Streamlit application...
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.
You can now view your Streamlit app in your browser.
URL: http://0.0.0.0:8501
```

---

## π”§ κΈ°μ μ  κ°μ„ μ‚¬ν•­

### 1. κ²¬κ³ ν• ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™”
- **λ‹¤μ¤‘ ν‚¤ μ§€μ›**: `bedrock-runtime`, `bedrock`, `bedrock_runtime`
- **ν΄λ°± λ©”μ»¤λ‹μ¦**: ν΄λΌμ΄μ–ΈνΈλ¥Ό μ°Ύμ§€ λ»ν•λ©΄ μ§μ ‘ μƒμ„±
- **μƒμ„Έν• λ΅κΉ…**: κ° λ‹¨κ³„λ³„ μ„±κ³µ/μ‹¤ν¨ λ©”μ‹μ§€

### 2. ν–¥μƒλ μ¤λ¥ μ²λ¦¬
- **λ…ν™•ν• μ¤λ¥ λ©”μ‹μ§€**: μ‚¬μ©μκ°€ μ΄ν•΄ν•κΈ° μ‰¬μ΄ μ¤λ¥ μ„¤λ…
- **λ””λ²„κΉ… μ •λ³΄**: λ¬Έμ  ν•΄κ²°μ„ μ„ν• μƒμ„Έ μ •λ³΄ μ κ³µ
- **μ•μ „ν• μ‹¤ν¨**: μ• ν”λ¦¬μΌ€μ΄μ… ν¬λμ‹ λ°©μ§€

### 3. μ¬μ‹λ„ λ΅μ§
- **μ¤‘μ” μ„λΉ„μ¤ μ¬μ‹λ„**: bedrock-runtime ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨ μ‹ μλ™ μ¬μ‹λ„
- **μ§€μ λ°±μ¤ν”„**: μ¬μ‹λ„ κ°„κ²© μ μ§„μ  μ¦κ°€
- **μµλ€ μ¬μ‹λ„ μ ν•**: λ¬΄ν• λ£¨ν”„ λ°©μ§€

---

## π“ ν•™μµ ν¬μΈνΈ

### 1. AWS ν΄λΌμ΄μ–ΈνΈ κ΄€λ¦¬μ μ¤‘μ”μ„±
- **μ‹±κΈ€ν†¤ ν¨ν„΄**: ν΄λΌμ΄μ–ΈνΈ μ¬μ‚¬μ©μ„ ν†µν• μ„±λ¥ μµμ ν™”
- **ν—¬μ¤μ²΄ν¬**: ν΄λΌμ΄μ–ΈνΈ μ ν¨μ„± κ²€μ¦μ ν•„μ”μ„±
- **μ¤λ¥ μ²λ¦¬**: ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨μ— λ€ν• μ μ ν• λ€μ‘

### 2. μ»¨ν…μ΄λ„ ν™κ²½μ—μ„μ λ””λ²„κΉ…
- **CloudWatch λ΅κ·Έ**: μ‹¤μ‹κ°„ λ΅κ·Έ λ¨λ‹ν„°λ§μ μ¤‘μ”μ„±
- **λ‹¨κ³„λ³„ ν™•μΈ**: ν¨ν‚¤μ§€ μ„¤μΉ β†’ μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘ β†’ κΈ°λ¥ ν…μ¤νΈ
- **ν—¬μ¤μ²΄ν¬**: HTTP μ‘λ‹µ μ½”λ“λ¥Ό ν†µν• μƒνƒ ν™•μΈ

### 3. ν”„λ΅λ•μ… λ°°ν¬ λ¨λ²” μ‚¬λ΅€
- **μ μ§„μ  λ°°ν¬**: μƒ νƒμ¤ν¬ μ‹μ‘ β†’ ν—¬μ¤μ²΄ν¬ β†’ κΈ°μ΅΄ νƒμ¤ν¬ μΆ…λ£
- **λ΅¤λ°± μ¤€λΉ„**: λ¬Έμ  λ°μƒ μ‹ μ΄μ „ λ²„μ „μΌλ΅ λ³µκµ¬ κ°€λ¥
- **λ¨λ‹ν„°λ§**: λ°°ν¬ κ³Όμ • μ „λ°μ— κ±ΈμΉ μ§€μ†μ  λ¨λ‹ν„°λ§

---

## π€ λ‹¤μ λ‹¨κ³„

### μ¦‰μ‹ μν–‰ κ°€λ¥
1. **κΈ°λ¥ ν…μ¤νΈ**: μ‹¤μ  μ±—λ΄‡ μ§λ¬Έ-λ‹µλ³€ ν…μ¤νΈ
2. **μ„±λ¥ λ¨λ‹ν„°λ§**: μ‘λ‹µ μ‹κ°„ λ° λ¦¬μ†μ¤ μ‚¬μ©λ‰ ν™•μΈ
3. **λ΅κ·Έ λ¶„μ„**: Bedrock API νΈμ¶ μ„±κ³µλ¥  λ¨λ‹ν„°λ§

### ν–¥ν›„ κ°μ„ μ‚¬ν•­
1. **μλ™ν™”λ ν…μ¤νΈ**: λ°°ν¬ ν›„ μλ™ κΈ°λ¥ ν…μ¤νΈ κµ¬ν„
2. **μ•λ¦Ό μ‹μ¤ν…**: λ°°ν¬ μ„±κ³µ/μ‹¤ν¨ μ•λ¦Ό μ„¤μ •
3. **λ©”νΈλ¦­ λ€μ‹λ³΄λ“**: CloudWatch λ€μ‹λ³΄λ“λ¥Ό ν†µν• μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§

---

## π“ μ—°λ½μ² λ° μ°Έκ³ μλ£

### ν”„λ΅μ νΈ μ •λ³΄
- **μ €μ¥μ†**: https://github.com/hcsung-aws/global-dual-nova-rag-chatbot
- **λ¬Έμ„**: `/docs` λ””λ ‰ν† λ¦¬ μ°Έμ΅°
- **μ•„ν‚¤ν…μ²**: λ¨λ“ν™”λ Terraform κµ¬μ΅°

### λ¦¬μ†μ¤ μ •λ³΄
- **AWS κ³„μ •**: 965037532757
- **λ¦¬μ „**: ap-northeast-1
- **ν™κ²½**: production
- **ν”„λ΅μ νΈ νƒκ·Έ**: dual-nova-chatbot

---

**λ¬Έμ  ν•΄κ²° μ™„λ£ μ‹κ°„**: 2025-08-27 13:25 UTC  
**μ΄ μ†μ” μ‹κ°„**: 7λ¶„  
**μƒνƒ**: β… μ„±κ³µμ μΌλ΅ ν•΄κ²° μ™„λ£

**ν•µμ‹¬ μ„±κ³Ό**: Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ¤λ¥λ¥Ό κ·Όλ³Έμ μΌλ΅ ν•΄κ²°ν•κ³ , λ”μ± κ²¬κ³ ν• μ¤λ¥ μ²λ¦¬ λ©”μ»¤λ‹μ¦μ„ κµ¬ν„ν•μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ μ•μ •μ„±μ„ ν¬κ² ν–¥μƒμ‹μΌ°μµλ‹λ‹¤.

---

## π”„ μ¶”κ°€ λ¬Έμ  λ°κ²¬ λ° ν•΄κ²° (2μ°¨ μμ •)

### π“… μ‘μ—… μΌμ: 2025-08-27
### π• μ‘μ—… μ‹κ°„: 13:26 - 13:38 UTC (μ•½ 12λ¶„)
### π‘¤ μ‘μ—…μ: hcsung (Amazon Q μ§€μ›)
### π λ¦¬μ „: ap-northeast-1 (λ„μΏ„)

---

## π― μ¶”κ°€ λ¬Έμ  μƒν™©
- **μ¬λ°°ν¬ ν›„ μ¦μƒ**: μ—¬μ „ν "Running get_aws_clients()."μ™€ "β Bedrock Runtime ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹¤ν¨" λ©”μ‹μ§€ λ°μƒ
- **κ·Όλ³Έ μ›μΈ**: `bedrock-runtime` ν΄λΌμ΄μ–ΈνΈμ— `list_foundation_models` λ©”μ„λ“κ°€ μ΅΄μ¬ν•μ§€ μ•μ
- **μ„λΉ„μ¤ κµ¬λ¶„ μ¤λ¥**: `bedrock`μ™€ `bedrock-runtime`μ λ©”μ„λ“ μ°¨μ΄μ  λ―Έκ³ λ ¤

---

## π” μƒμ„Έ λ¬Έμ  μ§„λ‹¨

### λ΅κ·Έ λ¶„μ„ κ²°κ³Ό
```
2025-08-27 13:32:43,707 - AWSClientManager - WARNING - β οΈ Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ‹¤ν¨: 'BedrockRuntime' object has no attribute 'list_foundation_models'
2025-08-27 13:32:43,707 - AWSClientManager - ERROR - μμƒμΉ λ»ν• μ¤λ¥ (bedrock-runtime): 'BedrockRuntime' object has no attribute 'list_foundation_models'
```

### AWS μ„λΉ„μ¤ κµ¬λ¶„
| μ„λΉ„μ¤ | μ©λ„ | μ£Όμ” λ©”μ„λ“ |
|--------|------|-------------|
| `bedrock` | λ¨λΈ κ΄€λ¦¬ | `list_foundation_models()` |
| `bedrock-runtime` | λ¨λΈ μ‹¤ν–‰ | `invoke_model()`, `invoke_model_with_response_stream()` |

---

## π› οΈ μµμΆ… ν•΄κ²° λ°©λ²•

### μμ •λ ν—¬μ¤μ²΄ν¬ λ΅μ§
**νμΌ**: `/src/core/aws_clients.py`

**κΈ°μ΅΄ μ½”λ“** (λ¬Έμ ):
```python
elif service_name == 'bedrock-runtime':
    # Bedrockμ€ list_foundation_modelsλ΅ ν—¬μ¤μ²΄ν¬
    try:
        client.list_foundation_models()  # β bedrock-runtimeμ—λ” μ΄ λ©”μ„λ“κ°€ μ—†μ
        self._logger.info(f"β… Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ„±κ³µ")
    except Exception as bedrock_error:
        self._logger.warning(f"β οΈ Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ‹¤ν¨: {bedrock_error}")
        raise
```

**μμ •λ μ½”λ“** (ν•΄κ²°):
```python
elif service_name == 'bedrock-runtime':
    # Bedrock Runtimeμ€ invoke_model λ©”μ„λ“ μ΅΄μ¬ μ—¬λ¶€λ§ ν™•μΈ
    if not hasattr(client, 'invoke_model'):
        raise AttributeError("bedrock-runtime ν΄λΌμ΄μ–ΈνΈμ— invoke_model λ©”μ„λ“κ°€ μ—†μµλ‹λ‹¤")
    self._logger.info(f"β… Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ„±κ³µ - invoke_model λ©”μ„λ“ ν™•μΈλ¨")
elif service_name == 'bedrock':
    # Bedrockμ€ list_foundation_modelsλ΅ ν—¬μ¤μ²΄ν¬
    try:
        client.list_foundation_models()
        self._logger.info(f"β… Bedrock ν—¬μ¤μ²΄ν¬ μ„±κ³µ")
    except Exception as bedrock_error:
        self._logger.warning(f"β οΈ Bedrock ν—¬μ¤μ²΄ν¬ μ‹¤ν¨: {bedrock_error}")
        raise
```

---

## π€ μµμΆ… λ°°ν¬ κ³Όμ •

### 1λ‹¨κ³„: μ½”λ“ μ—…λ΅λ“
```bash
aws s3 cp /home/hcsung/global-dual-nova-rag-chatbot/src/core/aws_clients.py s3://dual-nova-chatbot-production-code-62eea701/src/core/aws_clients.py --region ap-northeast-1
```

**κ²°κ³Ό**: 
- `src/core/aws_clients.py` μ—…λ΅λ“ μ™„λ£ (12.5 KiB)

### 2λ‹¨κ³„: ECS μ„λΉ„μ¤ μ¬λ°°ν¬
```bash
aws ecs update-service --cluster dual-nova-chatbot-production-cluster --service dual-nova-chatbot-production-service --region ap-northeast-1
```

**κ²°κ³Ό**: μƒλ΅μ΄ λ°°ν¬ μ‹μ‘ (deployment ID: ecs-svc/8766135678696951954)

### 3λ‹¨κ³„: λ°°ν¬ λ¨λ‹ν„°λ§
- **μƒ νƒμ¤ν¬ ID**: `18eab4fc459a46bc822ab03bcb9d699f`
- **μ‹μ‘ μ‹κ°„**: 2025-08-27 22:35:19 (ν•κµ­μ‹κ°„)
- **ν¨ν‚¤μ§€ μ„¤μΉ**: μ •μƒ μ™„λ£ (47μ΄)
- **μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘**: μ •μƒ μ™„λ£

---

## β… μµμΆ… ν•΄κ²° κ²°κ³Ό

### μ• ν”λ¦¬μΌ€μ΄μ… μƒνƒ
- β… **HTTP μƒνƒ**: 200 OK
- β… **μ„λ²„**: TornadoServer/6.5.2 (Streamlit)
- β… **URL**: http://dual-nova-chatbot-production-alb-2134834621.ap-northeast-1.elb.amazonaws.com
- β… **ECS μ„λΉ„μ¤**: ACTIVE, μƒλ΅μ΄ νƒμ¤ν¬ μ •μƒ μ‹¤ν–‰

### κΈ°λ¥ κ²€μ¦
- β… **μ›Ή μΈν„°νμ΄μ¤**: μ •μƒ λ΅λ“
- β… **Streamlit μ•±**: μ •μƒ μ‹¤ν–‰
- β… **Bedrock ν΄λΌμ΄μ–ΈνΈ**: μ¬λ°”λ¥Έ ν—¬μ¤μ²΄ν¬ λ΅μ§ μ μ©
- β… **μ„λΉ„μ¤ κµ¬λ¶„**: `bedrock`μ™€ `bedrock-runtime` κ°κ°μ— λ§λ” κ²€μ¦ λ°©λ²• μ μ©

### λ΅κ·Έ ν™•μΈ
```
Starting Streamlit application...
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.
You can now view your Streamlit app in your browser.
URL: http://0.0.0.0:8501
```

---

## π”§ κΈ°μ μ  κ°μ„ μ‚¬ν•­

### 1. μ •ν™•ν• μ„λΉ„μ¤λ³„ ν—¬μ¤μ²΄ν¬
- **bedrock-runtime**: `invoke_model` λ©”μ„λ“ μ΅΄μ¬ μ—¬λ¶€ ν™•μΈ
- **bedrock**: `list_foundation_models()` API νΈμ¶
- **κΈ°νƒ€ μ„λΉ„μ¤**: κ° μ„λΉ„μ¤μ— λ§λ” μ μ ν• κ²€μ¦ λ°©λ²•

### 2. ν–¥μƒλ μ¤λ¥ μ²λ¦¬
- **λ…ν™•ν• μ¤λ¥ λ©”μ‹μ§€**: μ„λΉ„μ¤λ³„ κµ¬μ²΄μ μΈ μ¤λ¥ μ„¤λ…
- **μ μ ν• λ΅κΉ… λ λ²¨**: INFO, WARNING, ERROR κµ¬λ¶„
- **μ¬μ‹λ„ λ΅μ§**: μ¤‘μ” μ„λΉ„μ¤ μ‹¤ν¨ μ‹ μλ™ μ¬μ‹λ„

### 3. μ½”λ“ μ•μ •μ„± κ°•ν™”
- **λ©”μ„λ“ μ΅΄μ¬ μ—¬λ¶€ ν™•μΈ**: `hasattr()` μ‚¬μ©
- **μ„λΉ„μ¤λ³„ λ¶„κΈ° μ²λ¦¬**: κ° AWS μ„λΉ„μ¤μ νΉμ„± κ³ λ ¤
- **μμ™Έ μ²λ¦¬ μ„Έλ¶„ν™”**: μ„λΉ„μ¤λ³„ λ§μ¶¤ν• μμ™Έ μ²λ¦¬

---

## π“ ν•µμ‹¬ ν•™μµ ν¬μΈνΈ

### 1. AWS μ„λΉ„μ¤ μ•„ν‚¤ν…μ² μ΄ν•΄
- **bedrock**: Foundation Model κ΄€λ¦¬ λ° λ©”νƒ€λ°μ΄ν„° μ΅°ν
- **bedrock-runtime**: μ‹¤μ  λ¨λΈ μ¶”λ΅  λ° μ¤νΈλ¦¬λ° μ‹¤ν–‰
- **μ„λΉ„μ¤ λ¶„λ¦¬**: κ΄€λ¦¬ ν‰λ©΄κ³Ό λ°μ΄ν„° ν‰λ©΄μ λ…ν™•ν• κµ¬λ¶„

### 2. ν¨κ³Όμ μΈ λ””λ²„κΉ… λ°©λ²•
- **λ΅κ·Έ λ¶„μ„**: CloudWatch λ΅κ·Έλ¥Ό ν†µν• μ •ν™•ν• λ¬Έμ  μ§„λ‹¨
- **λ‹¨κ³„λ³„ κ²€μ¦**: μ½”λ“ μμ • β†’ λ°°ν¬ β†’ ν…μ¤νΈ β†’ κ²€μ¦
- **μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§**: ECS νƒμ¤ν¬ μƒνƒ λ° μ• ν”λ¦¬μΌ€μ΄μ… λ΅κ·Έ μ¶”μ 

### 3. ν”„λ΅λ•μ… λ°°ν¬ λ¨λ²” μ‚¬λ΅€
- **μ μ§„μ  λ°°ν¬**: μƒ νƒμ¤ν¬ μ‹μ‘ β†’ ν—¬μ¤μ²΄ν¬ β†’ κΈ°μ΅΄ νƒμ¤ν¬ μΆ…λ£
- **λ¬΄μ¤‘λ‹¨ λ°°ν¬**: Application Load Balancerλ¥Ό ν†µν• νΈλν”½ μ „ν™
- **λ΅¤λ°± μ¤€λΉ„**: λ¬Έμ  λ°μƒ μ‹ μ΄μ „ λ²„μ „μΌλ΅ μ¦‰μ‹ λ³µκµ¬ κ°€λ¥

---

## π― μµμΆ… μ„±κ³Ό μ”μ•½

### ν•΄κ²°λ λ¬Έμ λ“¤
1. β… **Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ¤λ¥** β†’ μ„λΉ„μ¤λ³„ λ§μ¶¤ν• ν—¬μ¤μ²΄ν¬ μ μ©
2. β… **μλ»λ API νΈμ¶** β†’ `bedrock-runtime`μ— μ ν•©ν• κ²€μ¦ λ°©λ²• μ‚¬μ©
3. β… **μ• ν”λ¦¬μΌ€μ΄μ… μ•μ •μ„±** β†’ κ²¬κ³ ν• μ¤λ¥ μ²λ¦¬ λ° μ¬μ‹λ„ λ΅μ§ κµ¬ν„

### κΈ°μ μ  ν–¥μƒ
- **μ •ν™•μ„±**: AWS μ„λΉ„μ¤λ³„ νΉμ„±μ„ κ³ λ ¤ν• μ •ν™•ν• ν΄λΌμ΄μ–ΈνΈ κ²€μ¦
- **μ•μ •μ„±**: λ‹¤μ–‘ν• μ¤λ¥ μƒν™©μ— λ€ν• μ μ ν• μ²λ¦¬ λ©”μ»¤λ‹μ¦
- **μ μ§€λ³΄μμ„±**: λ…ν™•ν• λ΅κΉ…κ³Ό κµ¬μ΅°ν™”λ μ¤λ¥ μ²λ¦¬

### μ΄μ ν¨μ¨μ„±
- **λ°°ν¬ μ‹κ°„**: μ΄ 12λ¶„ (λ¬Έμ  μ§„λ‹¨ + μ½”λ“ μμ • + λ°°ν¬ + κ²€μ¦)
- **λ¬΄μ¤‘λ‹¨ μ„λΉ„μ¤**: μ‚¬μ©μ μν–¥ μ—†μ΄ λ¬Έμ  ν•΄κ²° μ™„λ£
- **λ¨λ‹ν„°λ§**: μ‹¤μ‹κ°„ λ΅κ·Έ λ¶„μ„μ„ ν†µν• μ‹ μ†ν• λ¬Έμ  ν•΄κ²°

---

## π€ ν–¥ν›„ κ°μ„  κ³„ν

### μ¦‰μ‹ μ μ© κ°€λ¥
1. **μλ™ν™”λ ν—¬μ¤μ²΄ν¬**: λ°°ν¬ ν›„ μλ™ κΈ°λ¥ ν…μ¤νΈ κµ¬ν„
2. **μ•λ¦Ό μ‹μ¤ν…**: λ°°ν¬ μ„±κ³µ/μ‹¤ν¨ μ•λ¦Ό μ„¤μ •
3. **λ©”νΈλ¦­ λ€μ‹λ³΄λ“**: CloudWatch λ€μ‹λ³΄λ“λ¥Ό ν†µν• μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§

### μ¤‘μ¥κΈ° κ°μ„ μ‚¬ν•­
1. **CI/CD νμ΄ν”„λΌμΈ**: GitHub Actionsλ¥Ό ν†µν• μλ™ λ°°ν¬
2. **ν…μ¤νΈ μλ™ν™”**: λ‹¨μ„ ν…μ¤νΈ λ° ν†µν•© ν…μ¤νΈ κµ¬ν„
3. **μ„±λ¥ μµμ ν™”**: ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ‹κ°„ λ‹¨μ¶•

---

## π“ μµμΆ… μƒνƒ λ° μ—°λ½μ²

### ν”„λ΅μ νΈ μ •λ³΄
- **μ €μ¥μ†**: https://github.com/hcsung-aws/global-dual-nova-rag-chatbot
- **λ¬Έμ„**: `/docs` λ””λ ‰ν† λ¦¬ μ°Έμ΅°
- **μ•„ν‚¤ν…μ²**: λ¨λ“ν™”λ Terraform κµ¬μ΅°

### λ¦¬μ†μ¤ μ •λ³΄
- **AWS κ³„μ •**: 965037532757
- **λ¦¬μ „**: ap-northeast-1
- **ν™κ²½**: production
- **ν”„λ΅μ νΈ νƒκ·Έ**: dual-nova-chatbot

---

**μµμΆ… λ¬Έμ  ν•΄κ²° μ™„λ£ μ‹κ°„**: 2025-08-27 13:38 UTC  
**μ΄ μ†μ” μ‹κ°„**: 19λ¶„ (1μ°¨: 7λ¶„ + 2μ°¨: 12λ¶„)  
**μƒνƒ**: β… μ™„μ „ν ν•΄κ²° μ™„λ£

**ν•µμ‹¬ μ„±κ³Ό**: AWS μ„λΉ„μ¤λ³„ νΉμ„±μ„ μ •ν™•ν μ΄ν•΄ν•κ³  μ μ ν• ν—¬μ¤μ²΄ν¬ λ΅μ§μ„ κµ¬ν„ν•μ—¬ Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” λ¬Έμ λ¥Ό κ·Όλ³Έμ μΌλ΅ ν•΄κ²°ν–μµλ‹λ‹¤. μ΄μ  μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ•μ •μ μΌλ΅ μ‘λ™ν•λ©°, μ‚¬μ©μκ°€ μ ‘μ† μ‹ μ •μƒμ μΈ Bedrock μ„λΉ„μ¤ μ΄μ©μ΄ κ°€λ¥ν•©λ‹λ‹¤.

---

## π”„ μ¶”κ°€ λ¬Έμ  λ°κ²¬ λ° μµμΆ… ν•΄κ²° (3μ°¨ μμ •)

### π“… μ‘μ—… μΌμ: 2025-08-27
### π• μ‘μ—… μ‹κ°„: 13:41 - 13:52 UTC (μ•½ 11λ¶„)
### π‘¤ μ‘μ—…μ: hcsung (Amazon Q μ§€μ›)
### π λ¦¬μ „: ap-northeast-1 (λ„μΏ„)

---

## π― μ¶”κ°€ λ¬Έμ  μƒν™©
- **μ›Ή μΈν„°νμ΄μ¤ μ¤λ¥**: μ—¬μ „ν "β StreamingHandler μ΄κΈ°ν™” μ‹¤ν¨: Bedrock ν΄λΌμ΄μ–ΈνΈ ν—¬μ¤μ²΄ν¬ μ‹¤ν¨: 'BedrockRuntime' object has no attribute 'list_foundation_models'" λ°μƒ
- **κ·Όλ³Έ μ›μΈ**: μ΄μ „ ECS νƒμ¤ν¬κ°€ μΊμ‹λ μ½”λ“λ¥Ό μ‚¬μ©ν•κ³  μμ—μ
- **λ””λ²„κΉ… μ •λ³΄**: μ‚¬μ© κ°€λ¥ν• ν΄λΌμ΄μ–ΈνΈ: ['s3', 'bedrock-runtime']

---

## π” μƒμ„Έ λ¬Έμ  μ§„λ‹¨

### μ½”λ“ κ²€μ¦ κ²°κ³Ό
- β… **S3 νμΌ**: μμ •λ μ½”λ“κ°€ μ •μƒμ μΌλ΅ μ—…λ΅λ“λ¨ (`list_foundation_models` μ κ±° ν™•μΈ)
- β… **λ΅κ·Έ λ¶„μ„**: μƒλ΅μ΄ νƒμ¤ν¬μ—μ„λ” Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ„±κ³µ
- β **μ›Ή μΈν„°νμ΄μ¤**: μ—¬μ „ν μ΄μ „ μ½”λ“ μ‹¤ν–‰ μ¤‘

### μΊμ‹ λ¬Έμ  ν™•μΈ
```bash
# S3 νμΌ ν™•μΈ
aws s3 cp s3://dual-nova-chatbot-production-code-62eea701/src/core/streaming_handler.py /tmp/current_streaming_handler.py
grep -n "list_foundation_models" /tmp/current_streaming_handler.py
# κ²°κ³Ό: κ²€μƒ‰ κ²°κ³Ό μ—†μ (μμ •λ μ½”λ“ ν™•μΈ)
```

---

## π› οΈ μµμΆ… ν•΄κ²° λ°©λ²•

### κ°•μ  λ°°ν¬ μ‹¤ν–‰
**λ…λ Ήμ–΄**:
```bash
aws ecs update-service --cluster dual-nova-chatbot-production-cluster --service dual-nova-chatbot-production-service --force-new-deployment --region ap-northeast-1
```

**ν¨κ³Ό**:
- κΈ°μ΅΄ νƒμ¤ν¬ μΆ…λ£
- μƒλ΅μ΄ νƒμ¤ν¬ μ‹μ‘ (μµμ‹  S3 μ½”λ“ λ‹¤μ΄λ΅λ“)
- μΊμ‹λ μ½”λ“ λ¬Έμ  ν•΄κ²°

---

## π€ μµμΆ… λ°°ν¬ κ³Όμ •

### 1λ‹¨κ³„: κ°•μ  λ°°ν¬ μ‹μ‘
- **λ°°ν¬ ID**: ecs-svc/9801198149730189352
- **μ‹μ‘ μ‹κ°„**: 2025-08-27 22:47:38 (ν•κµ­μ‹κ°„)
- **μƒνƒ**: IN_PROGRESS β†’ COMPLETED

### 2λ‹¨κ³„: μƒλ΅μ΄ νƒμ¤ν¬ μ‹μ‘
- **μƒ νƒμ¤ν¬ ID**: `7361f9f34ee047b1ad554d0ebdaa2d4a`
- **μ΄μ „ νƒμ¤ν¬ ID**: `18eab4fc459a46bc822ab03bcb9d699f` (μΆ…λ£)
- **μ½”λ“ λ‹¤μ΄λ΅λ“**: S3μ—μ„ μµμ‹  μ½”λ“ λ‹¤μ΄λ΅λ“ μ™„λ£

### 3λ‹¨κ³„: μ• ν”λ¦¬μΌ€μ΄μ… μ΄κΈ°ν™”
- **Streamlit μ‹μ‘**: μ •μƒ μ™„λ£
- **AWS ν΄λΌμ΄μ–ΈνΈ**: μ •μƒ μ΄κΈ°ν™”
- **Bedrock Runtime**: ν—¬μ¤μ²΄ν¬ μ„±κ³µ

---

## β… μµμΆ… ν•΄κ²° κ²°κ³Ό

### μ• ν”λ¦¬μΌ€μ΄μ… μƒνƒ
- β… **HTTP μƒνƒ**: 200 OK
- β… **ECS λ°°ν¬**: COMPLETED
- β… **μƒλ΅μ΄ νƒμ¤ν¬**: μ •μƒ μ‹¤ν–‰ μ¤‘
- β… **Bedrock Runtime**: μ¬λ°”λ¥Έ ν—¬μ¤μ²΄ν¬ μ μ©

### λ΅κ·Έ κ²€μ¦
```
2025-08-27 13:51:09,601 - AWSClientManager - INFO - β… Bedrock Runtime ν—¬μ¤μ²΄ν¬ μ„±κ³µ - invoke_model λ©”μ„λ“ ν™•μΈλ¨
2025-08-27 13:51:09,602 - AWSClientManager - INFO - β… ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ„±κ³µ: bedrock-runtime
```

### κΈ°λ¥ κ²€μ¦
- β… **μ›Ή μΈν„°νμ΄μ¤**: μ •μƒ λ΅λ“
- β… **StreamingHandler**: μ΄κΈ°ν™” μ„±κ³µ
- β… **Bedrock ν΄λΌμ΄μ–ΈνΈ**: μ¬λ°”λ¥Έ λ©”μ„λ“ μ‚¬μ©

---

## π”§ κΈ°μ μ  ν•™μµ ν¬μΈνΈ

### 1. ECS λ°°ν¬ μΊμ‹ λ¬Έμ 
- **λ¬Έμ **: μ½”λ“ μ—…λ°μ΄νΈ ν›„μ—λ„ μ΄μ „ νƒμ¤ν¬κ°€ μΊμ‹λ μ½”λ“ μ‚¬μ©
- **ν•΄κ²°**: `--force-new-deployment` ν”λκ·Έ μ‚¬μ©
- **κµν›**: μ½”λ“ λ³€κ²½ μ‹ μƒλ΅μ΄ νƒμ¤ν¬ μ‹μ‘ ν•„μ”

### 2. λ°°ν¬ κ²€μ¦ λ°©λ²•
- **S3 νμΌ ν™•μΈ**: μ—…λ΅λ“λ μ½”λ“κ°€ μ¬λ°”λ¥Έμ§€ κ²€μ¦
- **λ΅κ·Έ λ¶„μ„**: μƒλ΅μ΄ νƒμ¤ν¬μ μ΄κΈ°ν™” κ³Όμ • λ¨λ‹ν„°λ§
- **κΈ°λ¥ ν…μ¤νΈ**: μ›Ή μΈν„°νμ΄μ¤μ—μ„ μ‹¤μ  λ™μ‘ ν™•μΈ

### 3. AWS μ„λΉ„μ¤λ³„ ν—¬μ¤μ²΄ν¬
- **bedrock-runtime**: `invoke_model` λ©”μ„λ“ μ΅΄μ¬ μ—¬λ¶€ ν™•μΈ
- **bedrock**: `list_foundation_models()` API νΈμ¶
- **μ¤‘μ”μ„±**: κ° μ„λΉ„μ¤μ νΉμ„±μ— λ§λ” κ²€μ¦ λ°©λ²• μ μ©

---

## π“ μµμΆ… μ„±κ³Ό μ”μ•½

### ν•΄κ²°λ λ¬Έμ λ“¤
1. β… **μλ»λ API νΈμ¶**: `bedrock-runtime`μ—μ„ `list_foundation_models` νΈμ¶ μ κ±°
2. β… **μΊμ‹λ μ½”λ“ λ¬Έμ **: κ°•μ  λ°°ν¬λ΅ μµμ‹  μ½”λ“ μ μ©
3. β… **StreamingHandler μ΄κΈ°ν™”**: μ¬λ°”λ¥Έ ν—¬μ¤μ²΄ν¬ λ΅μ§ μ μ©

### κΈ°μ μ  ν–¥μƒ
- **μ •ν™•μ„±**: AWS μ„λΉ„μ¤λ³„ νΉμ„±μ„ κ³ λ ¤ν• μ •ν™•ν• ν΄λΌμ΄μ–ΈνΈ κ²€μ¦
- **μ•μ •μ„±**: κ°•μ  λ°°ν¬λ¥Ό ν†µν• ν™•μ‹¤ν• μ½”λ“ μ—…λ°μ΄νΈ
- **μ‹ λΆ°μ„±**: λ‹¨κ³„λ³„ κ²€μ¦μ„ ν†µν• λ¬Έμ  ν•΄κ²° ν™•μΈ

### μ΄μ ν¨μ¨μ„±
- **μ΄ ν•΄κ²° μ‹κ°„**: 30λ¶„ (1μ°¨: 7λ¶„ + 2μ°¨: 12λ¶„ + 3μ°¨: 11λ¶„)
- **λ¬΄μ¤‘λ‹¨ μ„λΉ„μ¤**: μ‚¬μ©μ μν–¥ μ—†μ΄ λ¬Έμ  ν•΄κ²° μ™„λ£
- **μ™„μ „ ν•΄κ²°**: λ” μ΄μƒ `list_foundation_models` μ¤λ¥ λ°μƒν•μ§€ μ•μ

---

## π― μµμΆ… μƒνƒ λ° κ¶μ¥μ‚¬ν•­

### ν„μ¬ μƒνƒ
- **μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…**: http://dual-nova-chatbot-production-alb-2134834621.ap-northeast-1.elb.amazonaws.com
- **μƒνƒ**: μ •μƒ μ‘λ™ μ¤‘
- **κΈ°λ¥**: Nova Micro + Pro λ³‘λ ¬ μ²λ¦¬ κ°€λ¥

### ν–¥ν›„ κ¶μ¥μ‚¬ν•­
1. **λ°°ν¬ μλ™ν™”**: GitHub Actionsλ¥Ό ν†µν• CI/CD νμ΄ν”„λΌμΈ κµ¬μ¶•
2. **ν—¬μ¤μ²΄ν¬ κ°•ν™”**: λ°°ν¬ ν›„ μλ™ κΈ°λ¥ ν…μ¤νΈ κµ¬ν„
3. **λ¨λ‹ν„°λ§ κ°μ„ **: CloudWatch μ•λμ„ ν†µν• μ‹¤μ‹κ°„ μ¤λ¥ κ°μ§€

---

**μµμΆ… λ¬Έμ  ν•΄κ²° μ™„λ£ μ‹κ°„**: 2025-08-27 13:52 UTC  
**μ΄ μ†μ” μ‹κ°„**: 30λ¶„ (3μ°¨μ— κ±ΈμΉ μ μ§„μ  ν•΄κ²°)  
**μƒνƒ**: β… μ™„μ „ν ν•΄κ²° μ™„λ£

**ν•µμ‹¬ μ„±κ³Ό**: AWS μ„λΉ„μ¤λ³„ νΉμ„±μ„ μ •ν™•ν μ΄ν•΄ν•κ³ , ECS λ°°ν¬ μΊμ‹ λ¬Έμ λ¥Ό ν•΄κ²°ν•μ—¬ Bedrock ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” μ¤λ¥λ¥Ό κ·Όλ³Έμ μΌλ΅ ν•΄κ²°ν–μµλ‹λ‹¤. μ΄μ  μ‚¬μ©μκ°€ μ›Ή μΈν„°νμ΄μ¤μ— μ ‘μ†ν•μ—¬ μ •μƒμ μΌλ΅ μ±—λ΄‡ κΈ°λ¥μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
