Global Dual Nova RAG Chatbot - Architecture Diagram

┌─────────────────────────────────────────────────────────────────────────────────┐
│                                   Internet                                      │
│                              (Users Worldwide)                                 │
└─────────────────────────────┬───────────────────────────────────────────────────┘
                              │ HTTPS/HTTP
                              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                     Application Load Balancer (ALB)                            │
│                          Multi-AZ, Auto-scaling                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   Target Group  │  │  Health Checks  │  │  Access Logs    │                │
│  │   (Port 8501)   │  │  (HTTP /health) │  │  (S3 Storage)   │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
└─────────────────────────────┬───────────────────────────────────────────────────┘
                              │ Internal Traffic
                              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              VPC (10.0.0.0/16)                                 │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Public Subnets                                   │   │
│  │                   (10.0.1.0/24, 10.0.2.0/24)                           │   │
│  │                                                                         │   │
│  │  ┌─────────────┐              ┌─────────────┐                          │   │
│  │  │ NAT Gateway │              │ NAT Gateway │                          │   │
│  │  │   (AZ-1)    │              │   (AZ-2)    │                          │   │
│  │  └─────────────┘              └─────────────┘                          │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                              │                                                 │
│  ┌─────────────────────────────▼─────────────────────────────────────────────┐   │
│  │                        Private Subnets                                   │   │
│  │                  (10.0.10.0/24, 10.0.20.0/24)                          │   │
│  │                                                                         │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    ECS Fargate Cluster                          │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐            │   │   │
│  │  │  │ Streamlit   │  │ Streamlit   │  │ Streamlit   │            │   │   │
│  │  │  │ Container   │  │ Container   │  │ Container   │            │   │   │
│  │  │  │ (Task 1)    │  │ (Task 2)    │  │ (Task N)    │            │   │   │
│  │  │  │             │  │             │  │             │            │   │   │
│  │  │  │ • Nova API  │  │ • Nova API  │  │ • Nova API  │            │   │   │
│  │  │  │ • RAG Logic │  │ • RAG Logic │  │ • RAG Logic │            │   │   │
│  │  │  │ • Dual Lang │  │ • Dual Lang │  │ • Dual Lang │            │   │   │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘            │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                              │
                              ▼ API Calls
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            AWS Services Layer                                  │
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   Amazon        │  │   Amazon        │  │      S3         │                │
│  │   Bedrock       │  │   Bedrock       │  │   Buckets       │                │
│  │                 │  │                 │  │                 │                │
│  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────┐ │                │
│  │ │ Nova Micro  │ │  │ │ Knowledge   │ │  │ │ Code Store  │ │                │
│  │ │   Model     │ │  │ │    Base     │ │  │ │ ALB Logs    │ │                │
│  │ └─────────────┘ │  │ │             │ │  │ └─────────────┘ │                │
│  │ ┌─────────────┐ │  │ │ ┌─────────┐ │ │  └─────────────────┘                │
│  │ │ Nova Pro    │ │  │ │ │Data Src │ │ │                                     │
│  │ │   Model     │ │  │ │ │   #1    │ │ │  ┌─────────────────┐                │
│  │ └─────────────┘ │  │ │ └─────────┘ │ │  │   Secrets       │                │
│  └─────────────────┘  │ │ ┌─────────┐ │ │  │   Manager       │                │
│                       │ │ │Data Src │ │ │  │                 │                │
│                       │ │ │   #2    │ │ │  │ ┌─────────────┐ │                │
│                       │ │ └─────────┘ │ │  │ │ App Config  │ │                │
│                       │ └─────────────┘ │  │ │ Notion Token│ │                │
│                       └─────────────────┘  │ └─────────────┘ │                │
│                                            └─────────────────┘                │
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   CloudWatch    │  │      IAM        │  │   Auto Scaling  │                │
│  │     Logs        │  │     Roles       │  │     Groups      │                │
│  │                 │  │                 │  │                 │                │
│  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────┐ │                │
│  │ │ ECS Logs    │ │  │ │Task Exec    │ │  │ │CPU Scaling  │ │                │
│  │ │ ALB Logs    │ │  │ │Task Role    │ │  │ │Memory Scale │ │                │
│  │ │ App Logs    │ │  │ │             │ │  │ │             │ │                │
│  │ └─────────────┘ │  │ └─────────────┘ │  │ └─────────────┘ │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
└─────────────────────────────────────────────────────────────────────────────────┘

Data Flow Diagram:

User Query → Language Detection → Dual Processing Path

Korean User Path:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Korean      │ -> │ Knowledge   │ -> │ Nova Micro  │ -> │ Korean      │
│ Query       │    │ Base RAG    │    │ + Nova Pro  │    │ Response    │
│             │    │             │    │ (Parallel)  │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

English User Path:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ English     │ -> │ Knowledge   │ -> │ Step 1:     │ -> │ Korean      │
│ Query       │    │ Base RAG    │    │ KO Response │    │ Response    │
│             │    │             │    │ (Micro+Pro) │    │ (Staff)     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                              │
                                              ▼
                                     ┌─────────────┐    ┌─────────────┐
                                     │ Step 2:     │ -> │ English     │
                                     │ EN Response │    │ Response    │
                                     │ (Micro+Pro) │    │ (Customer)  │
                                     └─────────────┘    └─────────────┘

Parallel Processing Pattern (GitHub Original):
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        ThreadPoolExecutor                                      │
│                                                                                 │
│  Background Thread              │              Foreground Thread               │
│  ┌─────────────────┐           │           ┌─────────────────┐                │
│  │   Nova Pro      │           │           │   Nova Micro    │                │
│  │   Model         │           │           │   Model         │                │
│  │                 │           │           │                 │                │
│  │ • Detailed      │           │           │ • Fast Response │                │
│  │   Analysis      │           │           │ • Real-time     │                │
│  │ • Buffer        │           │           │   Streaming     │                │
│  │   Collection    │           │           │ • User Visible  │                │
│  │ • Async Exec    │           │           │ • Immediate     │                │
│  └─────────────────┘           │           └─────────────────┘                │
│           │                    │                    │                         │
│           ▼                    │                    ▼                         │
│  ┌─────────────────┐           │           ┌─────────────────┐                │
│  │ Buffer Storage  │           │           │ Stream Display  │                │
│  │ • Chunk by     │           │           │ • Chunk by      │                │
│  │   Chunk        │           │           │   Chunk         │                │
│  │ • Complete     │           │           │ • Real-time     │                │
│  │   Collection   │           │           │   Update        │                │
│  └─────────────────┘           │           └─────────────────┘                │
│                                │                                               │
└─────────────────────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼ Merge Results
                        ┌─────────────────┐
                        │ Combined Output │
                        │ • Micro First   │
                        │ • Pro Detailed  │
                        │ • Natural Flow  │
                        └─────────────────┘

Security Architecture:
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            Security Layers                                     │
│                                                                                 │
│  Network Security          │  Application Security    │  Data Security          │
│  ┌─────────────────┐      │  ┌─────────────────┐     │  ┌─────────────────┐   │
│  │ • Private       │      │  │ • IAM Roles     │     │  │ • Encryption    │   │
│  │   Subnets       │      │  │ • Least         │     │  │   at Rest       │   │
│  │ • Security      │      │  │   Privilege     │     │  │ • Encryption    │   │
│  │   Groups        │      │  │ • Secrets       │     │  │   in Transit    │   │
│  │ • NACLs         │      │  │   Manager       │     │  │ • Access        │   │
│  │ • WAF Ready     │      │  │ • Container     │     │  │   Logging       │   │
│  └─────────────────┘      │  │   Security      │     │  │ • Audit Trail   │   │
│                           │  └─────────────────┘     │  └─────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
